@startuml

(*) --> "Receive a request to change user's password"

if "Request: changePassword" then
    --> "Retrieve the user by username"
    --> if "User found" then
        --> "Check if old password matches"
        --> if "Old password matches" then
            --> "Check if new password matches re-entered password"
            --> if "New password matches" then
                --> "Encode and save the new password"
                --> "Return success message"
                --> (*)
            else
                --> "Return error message (new password mismatch)"
                --> (*)
            endif
        else
            --> "Return error message (incorrect old password)"
            --> (*)
        endif
    else
        --> "Return error message (user not found)"
        --> (*)
    endif
else
    --> "Invalid request"
    --> "Return error message"
    --> (*)
endif

@enduml
